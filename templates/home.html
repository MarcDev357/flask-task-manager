<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Task Manager</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

</head>
<body class="bg-light">
	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
	  <div class="container-fluid">
		<a class="navbar-brand" href="#">Task Manager</a>
	  </div>
	</nav>
  
	<!-- Main Content -->
	<div class="container py-5 d-flex justify-content-center">
		<div class="card shadow rounded w-100" style="max-width: 800px;">
		  <div class="card-body px-4 py-4">	  
		  <h1 class="text-center mb-4">Task Manager!</h1>
  
		  <!-- Flash Messages -->
		  {% with messages = get_flashed_messages() %}
			{% if messages %}
			  {% for message in messages %}
				<div class="alert alert-success alert-dismissible fade show" role="alert">
				  {{ message }}
				  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
			  {% endfor %}
			{% endif %}
		  {% endwith %}
  
		  <!-- Add Task Form -->
		  <form action="/add" method="POST" class="row g-2 mb-4">
			<div class="col-md-6">
			  <input type="text" name="content" class="form-control" placeholder="Enter a new task" required>
			</div>
			<div class="col-md-3">
			  <input type="date" name="due_date" class="form-control" placeholder="Due date">
			</div>
			<div class="col-md-2">
			  <select name="priority" class="form-select">
				<option value="1">Low</option>
				<option value="2">Medium</option>
				<option value="3">High</option>
			  </select>
			</div>
			<div class="col-md-1">
			  <button type="submit" class="btn btn-primary w-100">Add</button>
			</div>
		  </form>

		  <form method="GET" class="mb-3">
			<div class="row g-2 align-items-center">
			  <div class="col-md-4 col-sm-6">
				<select name="filter" class="form-select" onchange="this.form.submit()">
				  <option value="" {% if request.args.get('filter') == None %}selected{% endif %}>All Tasks</option>
				  <option value="overdue" {% if request.args.get('filter') == 'overdue' %}selected{% endif %}>Overdue</option>
				  <option value="today" {% if request.args.get('filter') == 'today' %}selected{% endif %}>Due Today</option>
				  <option value="upcoming" {% if request.args.get('filter') == 'upcoming' %}selected{% endif %}>Upcoming</option>
				  <option value="completed" {% if request.args.get('filter') == 'completed' %}selected{% endif %}>Completed</option>
				  <option value="high" {% if request.args.get('filter') == 'high' %}selected{% endif %}>High Priority</option>
				  <option value="medium" {% if request.args.get('filter') == 'medium' %}selected{% endif %}>Medium Priority</option>
				  <option value="low" {% if request.args.get('filter') == 'low' %}selected{% endif %}>Low Priority</option>
				</select>
			  </div>
			</div>
		  </form>
		  

		  <!-- Task List -->
		  <h4 class="mb-3">Tasks:</h4>
		  <ul class="list-group">

			<!-- ðŸ”´ Overdue Section -->
			<li class="list-group-item fw-bold bg-light text-dark text-uppercase border-0">
			  ðŸ”´ Overdue
			</li>
			{% for task in tasks if not task.completed and task.due_date and task.due_date < current_date %}
			  {% include 'task_item.html' %}
			{% endfor %}
		  
			<!-- ðŸŸ¡ Upcoming Section -->
			<li class="list-group-item fw-bold bg-light text-dark text-uppercase border-0 mt-3">
			  ðŸŸ¡ Upcoming
			</li>
			{% for task in tasks if not task.completed and (not task.due_date or task.due_date >= current_date) %}
			  {% include 'task_item.html' %}
			{% endfor %}
		  
			<!-- âœ… Completed Section -->
			<li class="list-group-item fw-bold bg-light text-dark text-uppercase border-0 mt-3">
			  âœ… Completed
			</li>
			{% for task in tasks if task.completed %}
			  {% include 'task_item.html' %}
			{% endfor %}
		  
		  </ul>
		  
		</div>
	  </div>
	</div>
  
	<!-- Auto-dismiss Flash Message -->
	<script>
	  setTimeout(function() {
		let alert = document.querySelector('.alert');
		if (alert) {
		  alert.classList.remove('show');
		  alert.classList.add('fade');
		}
	  }, 3000);
	</script>
  
	<!-- Bootstrap JS (keep this at the bottom) -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
  
